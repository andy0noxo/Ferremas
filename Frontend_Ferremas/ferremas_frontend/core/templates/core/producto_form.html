{% extends 'base.html' %}
{% block title %}{{ accion }} Producto{% endblock %}
{% block nav %}
<ul>
    <li><a href="{% url 'core:dashboard' %}">Inicio</a></li>
    <li><a href="{% url 'core:productos_list' %}">Productos</a></li>
</ul>
{% endblock %}
{% block content %}
<h2>{{ accion }} Producto</h2>
{% if form.errors %}
    <div class="errorlist">
        <ul>
        {% for field in form %}
            {% for error in field.errors %}
                <li>{{ field.label }}: {{ error }}</li>
            {% endfor %}
        {% endfor %}
        {% for error in form.non_field_errors %}
            <li>{{ error }}</li>
        {% endfor %}
        </ul>
    </div>
{% endif %}
<form method="post">
    {% csrf_token %}
    <label for="nombre">Nombre:</label>
    <input type="text" id="nombre" name="nombre" value="{{ form.nombre.value|default:'' }}" required><br>
    <label for="descripcion">Descripción:</label>
    <input type="text" id="descripcion" name="descripcion" value="{{ form.descripcion.value|default:'' }}"><br>
    <label for="precio">Precio:</label>
    <input type="number" id="precio" name="precio" value="{{ form.precio.value|default:'' }}" min="1" required><br>
    <label for="marca_id">Marca:</label>
    <select id="marca_id" name="marca_id" required>
        <option value="">Seleccione</option>
        {% for marca in marcas %}
            <option value="{{ marca.id }}" {% if form.marca_id.value|stringformat:'s' == marca.id|stringformat:'s' %}selected{% endif %}>{{ marca.nombre }}</option>
        {% endfor %}
    </select><br>
    <label for="categoria_id">Categoría:</label>
    <select id="categoria_id" name="categoria_id" required>
        <option value="">Seleccione</option>
        {% for categoria in categorias %}
            <option value="{{ categoria.id }}" {% if form.categoria_id.value|stringformat:'s' == categoria.id|stringformat:'s' %}selected{% endif %}>{{ categoria.nombre }}</option>
        {% endfor %}
    </select><br>
    <button type="submit">{{ accion }}</button>
</form>
{% if accion == 'Editar' and producto %}
<form method="post" action="{% url 'core:producto_eliminar' producto.id %}" style="margin-top:1em;">
    {% csrf_token %}
    <button type="submit" onclick="return confirm('¿Seguro que desea eliminar este producto?');">Eliminar</button>
</form>
{% endif %}
<a href="{% url 'core:productos_list' %}">Volver al listado</a>
{% endblock %}
